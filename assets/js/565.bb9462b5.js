(window.webpackJsonp=window.webpackJsonp||[]).push([[565],{983:function(t,s,a){"use strict";a.r(s);var n=a(15),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[a("img",{attrs:{src:"/images/054.png",alt:"image"}})]),t._v(" "),a("h3",{attrs:{id:"一、xss-攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、xss-攻击"}},[t._v("#")]),t._v(" 一、XSS 攻击")]),t._v(" "),a("p",[a("strong",[t._v("XSS")]),t._v(" 攻击的全称为 "),a("code",[t._v("跨站脚本攻击（Cross Site Scripting）")])]),t._v(" "),a("blockquote",[a("p",[t._v("为什么不叫"),a("code",[t._v("CSS")]),t._v(" ，那是因为为了不跟层叠样式表（Cascading Style Sheet，CSS）混淆")])]),t._v(" "),a("p",[a("strong",[t._v("XSS攻击")]),t._v(" 是 "),a("strong",[t._v("Web")]),t._v(" 应用中最常见到的攻击手段之一。"),a("strong",[t._v("跨站脚本攻击")]),t._v("，关键词 "),a("code",[t._v("脚本")]),t._v("。攻击者常常在网页中嵌入了恶意的脚本程序，当用户打开该网页的时候，脚本程序便开始在客户端的浏览器后台执行，常用于盗取客户端的 "),a("strong",[t._v("cookie")]),t._v("，用户名密码，下载执行病毒的木马程序，以及获取客户端 "),a("strong",[t._v("Admin")]),t._v(" 权限。")]),t._v(" "),a("h4",{attrs:{id:"_1-攻击原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-攻击原理"}},[t._v("#")]),t._v(" 1. 攻击原理")]),t._v(" "),a("p",[t._v("前端常用表单的形式向后台提交信息")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("cbuc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("  \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("很普通的一段"),a("strong",[t._v("html")]),t._v("代码，向后台提交 "),a("strong",[t._v("username")]),t._v(" 的信息，正常情况下，用户一般会输入自己的 "),a("strong",[t._v("username")]),t._v("，这个时候毫无问题，但是在不正常的情况下，用户输入的不是一个正常的字符串，而是 "),a("code",[t._v('"/><script> alert("bingo") <\/script><!-')]),t._v(" 。按这个时候表单的内容就会变成")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bingo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v('!-"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("  \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("这个时候向后台提交参数，由于 username 的不合法性，校验可能不通过，服务端就重定向会该页面，并且带上以上参数，这个时候页面就会弹出一个警告框：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/055.png",alt:"image"}})]),t._v(" "),a("p",[t._v("警告框问题不是很大，是因为取决于这段脚本，如果攻击者稍做修改，那么性质可能就不一样了~甚至，攻击者可以对URL进行操作，正常提交的地址为")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('www.xxx.com/login?username="/><script> alert("bingo") <\/script><!-"  \n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("攻击者可以对 URL 进行编码用来迷惑用户：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('www.xxx.com/login?username="%2F%3E%3Cscript%3E%20alert(%22bingo%22)%20%3C%2Fscript%3E%3C!-"  \n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-防护手段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-防护手段"}},[t._v("#")]),t._v(" 2. 防护手段")]),t._v(" "),a("p",[t._v("知道了如何攻击，防护起来就不难，我们对症下药即可。既然输入的参数不合法，我们就很有必要对入参进行校验，比如 "),a("code",[t._v("<、>、\"、\"、'、'")]),t._v("  这些特殊字符我们很有必要进行转义与校验。")]),t._v(" "),a("h3",{attrs:{id:"二、csrf-攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、csrf-攻击"}},[t._v("#")]),t._v(" 二、CSRF 攻击")]),t._v(" "),a("p",[a("strong",[t._v("CSRF")]),t._v(" 攻击全称 "),a("code",[t._v("跨站请求伪造 (Cross site request forgery)")]),t._v("。是一种对网站的恶意利用，我们上面说到的 "),a("strong",[t._v("XSS攻击")]),t._v(" 是利用站点内的信任用户，自己去触发脚本而导致的攻击。而 "),a("strong",[t._v("CSRF")]),t._v(" 则是通过伪装来自受信任用户的请求去利用受攻击的网站。")]),t._v(" "),a("p",[a("strong",[t._v("CSRF 攻击")]),t._v("，关键词："),a("code",[t._v("伪造")]),t._v("。")]),t._v(" "),a("p",[t._v("攻击者盗用了访问用户的身份，以访问者的名义向第三方网站发送恶意请求，常用于利用访问者的身份发送消息，进行交易转账以及盗取账号。")]),t._v(" "),a("h4",{attrs:{id:"_1-攻击原理-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-攻击原理-2"}},[t._v("#")]),t._v(" 1. 攻击原理")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/056.png",alt:"image"}})]),t._v(" "),a("p",[a("strong",[t._v("受害者")]),t._v("首先在"),a("strong",[t._v("信任站点")]),t._v("完成了登录，并且生成了 Cookie，Cookie会在浏览器保存一定的时间。到这一步，用户如果在没有登出 "),a("strong",[t._v("信任站点")]),t._v(" 的情况下，访问了 "),a("strong",[t._v("恶意站点")]),t._v("，这个时候 "),a("strong",[t._v("恶意站点")]),t._v(" 就会向 "),a("strong",[t._v("信任站点")]),t._v(" 发起请求，这个请求就会带上以上生成的 Cookie，当恶意请求来到 "),a("strong",[t._v("信任站点")]),t._v("，"),a("strong",[t._v("信任站点")]),t._v(" 看到请求携带的 Cookie，就会判断该请求是 "),a("strong",[t._v("受害者")]),t._v(" 发出的。因此 "),a("strong",[t._v("信任站点")]),t._v(" 就会根据 "),a("strong",[t._v("受害者")]),t._v(" 的权限来完成 "),a("strong",[t._v("恶意请求")]),t._v(" 的指令，而这个指令可能是利用 "),a("strong",[t._v("受害者")]),t._v(" 的身份发送消息，转账支付等等操作，这样 "),a("strong",[t._v("恶意站点")]),t._v(" 就达到了伪造 "),a("strong",[t._v("受害者")]),t._v(" 请求 "),a("strong",[t._v("信任站点")]),t._v(" 的目的。看到这个流程不知道你是否有所启发，不知道屏幕前的小伙伴是否有过 "),a("code",[t._v("QQ")]),t._v(" 被盗用的经历，当然，有些盗用的手段与上面的流程是相似的。该攻击手段在日常中十分常见。如果某个支付系统的转账地址为 "),a("code",[t._v("www.xxx.com/pay?accountNum=xxxx&money=xxx")]),t._v("。其中 "),a("strong",[t._v("accountNum")]),t._v(" 为转账目的的账户，"),a("strong",[t._v("money")]),t._v(" 为转账金额。那这个时候如果你刚巧登录过了该支付系统，又没有及时的登出，在访问"),a("code",[t._v("恶意站点")]),t._v("的时候，如果你点开了某张图片，而图片的地址为 ：")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("img")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("www.xxx.com/pay?accountNum=xxxx&money=xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("  \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("当你美滋滋地浏览图片的时候，却不知道此时你的账户上已经悄悄的少了指定金额！这就是因为你没有及时的登出"),a("code",[t._v("支付系统")]),t._v("，而又点击了 "),a("code",[t._v("恶意站点")]),t._v("的 "),a("strong",[t._v("恶意链接")]),t._v("，携带了你未过期的 Cookie，成功窃取了你的金额。")]),t._v(" "),a("h4",{attrs:{id:"_2-防护手段-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-防护手段-2"}},[t._v("#")]),t._v(" 2. 防护手段")]),t._v(" "),a("p",[t._v("同样知其症下其药！防护手段如下：")]),t._v(" "),a("ul",[a("li",[t._v("将 cookie 设置为 HttpOnly")])]),t._v(" "),a("p",[a("strong",[t._v("CSRF")]),t._v(" 攻击的关键就在于利用了用户未过期的 "),a("strong",[t._v("Cookie")]),t._v("，那么为了防止 "),a("strong",[t._v("Cookie")]),t._v(" 的盗取，就需要在 "),a("strong",[t._v("Cookie")]),t._v(" 中设置 "),a("strong",[t._v("HttpOnly")]),t._v(" 属性，这样通过程序（"),a("code",[t._v("XSS 攻击")]),t._v("）就无法读取到 "),a("strong",[t._v("Cookie")]),t._v(" 信息，避免了攻击者伪造 "),a("strong",[t._v("Cookie")]),t._v(" 的情况出现。")]),t._v(" "),a("ul",[a("li",[t._v("增加 token")])]),t._v(" "),a("p",[t._v("该防护手段还是针对 "),a("strong",[t._v("Cookie")]),t._v(" 的盗取，由于请求中所有的用户验证信息都存放于 "),a("strong",[t._v("Cookie")]),t._v(" 中，因为我们抵御 "),a("strong",[t._v("CSRF")]),t._v(" 的关键就在于："),a("strong",[t._v("如何在请求中放入攻击者所不能伪造的信息")]),t._v("，并且该信息不能存放在 "),a("strong",[t._v("Cookie")]),t._v(" 中。那么我们就可以在请求返回中加入一个随机生成的 "),a("code",[t._v("token")]),t._v("，当请求来到时进行 "),a("strong",[t._v("token")]),t._v(" 的校验，如果校验不通过则认为是 "),a("strong",[t._v("CSRF")]),t._v(" 攻击而拒绝该请求。")]),t._v(" "),a("ul",[a("li",[t._v("通过 Referer")])]),t._v(" "),a("p",[t._v("根据 "),a("strong",[t._v("HTTP")]),t._v(" 协议，在 "),a("strong",[t._v("HTTP")]),t._v(" 请求头上有一个字段叫做 "),a("code",[t._v("referer")]),t._v("，它记录了该"),a("strong",[t._v("Http")]),t._v(" 请求的来源地址。在通常情况下，访问一个安全受限的页面的请求都来自同一个网站。在 "),a("strong",[t._v("CSRF")]),t._v(" 中恶意请求是从 "),a("strong",[t._v("恶意站点")]),t._v(" 发出的，因此要防御 "),a("strong",[t._v("CSRF")]),t._v(" 攻击，需要对每一个请求验证其 "),a("strong",[t._v("referer")]),t._v(" 值即可。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/057.png",alt:"image"}})]),t._v(" "),a("h4",{attrs:{id:"参考文章链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章链接"}},[t._v("#")]),t._v(" 参考文章链接")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://tech.meituan.com/2018/09/27/fe-security.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端安全系列（一）：如何防止XSS攻击？"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://tech.meituan.com/2018/10/11/fe-security-csrf.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端安全系列（二）：如何防止CSRF攻击？"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);